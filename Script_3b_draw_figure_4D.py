"""
Using :
-- An example makes custom 'pie charts' as the markers for a scatter plot
-- Thanks to Manuel Metz for the example
"""
import math
import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.basemap import Basemap
 
#Requires cartopy enthought to run
 
colors = ['#0066CC','#006600','#CC0000','#FF9900']
 
def draw_pie(ax,ratios=[0.25,0.25,0.25,0.25], X=0, Y=0, size = 1000):
    N = len(ratios)
 
    xy = []
 
    start = 0.
    for ratio in ratios:
        x = [0] + np.cos(np.linspace(2*math.pi*start,2*math.pi*(start+ratio), 30)).tolist()
        y = [0] + np.sin(np.linspace(2*math.pi*start,2*math.pi*(start+ratio), 30)).tolist()
        xy1 = zip(x,y)
        xy.append(xy1)
        start += ratio
 
    for i, xyi in enumerate(xy):
        ax.scatter([X],[Y] , marker=(xyi,0), s=size, facecolor=colors[i] , alpha=0.9,  linewidths=0)
 
fig = plt.figure(figsize=(11.7,8.3))
#Custom adjust of the subplots
plt.subplots_adjust(left=0.05,right=0.95,top=0.90,bottom=0.05,wspace=0.15,hspace=0.05)
ax = plt.subplot(111)

m = Basemap(projection='merc', lat_0 = 56, lon_0 = -3,
    resolution = 'h', area_thresh = 0.1,
    llcrnrlon=-1, llcrnrlat=55.0,
    urcrnrlon=-8.25, urcrnrlat=58.75)
 
m.drawcoastlines()
m.drawcountries()
m.drawmapboundary()

# X, Y coordinates for each pie chart
#Values for segments in order of Type1, Type2, Type3, Type4

X,Y = m(-2.803598,56.539009)
draw_pie(ax,[0.251606979,0,0.748393021,0], X, Y,size=500)
X,Y = m(-2.7978858,56.539567)
draw_pie(ax,[0.645139127,0,0.354860873,0], X, Y,size=500)
X,Y = m(-2.9620053,56.539914)
draw_pie(ax,[0.361160874,0,0.638839126,0], X, Y,size=500)
X,Y = m(-2.6319437,56.610992)
draw_pie(ax,[0.334298119,0,0.665701881,0], X, Y,size=500)
X,Y = m(-2.978413,56.592838)
draw_pie(ax,[0.144862155,0,0.855137845,0], X, Y,size=500)
X,Y = m(-2.8159914,56.679602)
draw_pie(ax,[0.249596478,0,0.750403522,0], X, Y,size=500)
X,Y = m(-2.8836135,56.545051)
draw_pie(ax,[0.173326414,0,0.826673586,0], X, Y,size=500)
X,Y = m(-2.5962098,56.611636)
draw_pie(ax,[0.209472982,0,0.790527018,0], X, Y,size=500)
X,Y = m(-2.8260813,56.703594)
draw_pie(ax,[0.229393195,0,0.770606805,0], X, Y,size=500)
X,Y = m(-2.8260813,56.703594)
draw_pie(ax,[0.138218152,0,0.861781848,0], X, Y,size=500)
X,Y = m(-2.2193525,57.197286)
draw_pie(ax,[0,0.924993003,0.075006997,0], X, Y,size=500)
X,Y = m(-2.8435591,56.570782)
draw_pie(ax,[0.093049327,0,0.906950673,0], X, Y,size=500)
X,Y = m(-3.3135832,56.257908)
draw_pie(ax,[0.524499361,0,0.475500639,0], X, Y,size=500)
X,Y = m(-2.8312323,56.019057)
draw_pie(ax,[0.22456095,0,0.77543905,0], X, Y,size=500)
X,Y = m(-2.8312323,56.019057)
draw_pie(ax,[0,0.485956416,0.514043584,0], X, Y,size=500)
X,Y = m(-2.8312323,56.019057)
draw_pie(ax,[0.062616001,0.690827391,0.246556608,0], X, Y,size=500)
X,Y = m(-2.8312323,56.019057)
draw_pie(ax,[0.08899762,0.158291457,0.752710923,0], X, Y,size=500)
X,Y = m(-2.8312323,56.019057)
draw_pie(ax,[0,0.132850242,0.867149758,0], X, Y,size=500)
X,Y = m(-2.8312323,56.019057)
draw_pie(ax,[0.225501114,0.689371443,0.085127444,0], X, Y,size=500)
X,Y = m(-2.8312323,56.019057)
draw_pie(ax,[0.371089536,0,0.628910464,0], X, Y,size=500)
X,Y = m(-2.8312323,56.019057)
draw_pie(ax,[0,0.936458952,0.063541048,0], X, Y,size=500)
X,Y = m(-2.8312323,56.019057)
draw_pie(ax,[0.235498646,0.764501354,0,0], X, Y,size=500)
X,Y = m(-3.3135832,56.257908)
draw_pie(ax,[0.267484796,0,0.732515204,0], X, Y,size=500)
X,Y = m(-3.3135832,56.257908)
draw_pie(ax,[0.231994295,0,0.768005705,0], X, Y,size=500)
X,Y = m(-2.8312323,56.019057)
draw_pie(ax,[0.257828505,0,0.742171495,0], X, Y,size=500)
X,Y = m(-2.8312323,56.019057)
draw_pie(ax,[0.310976237,0,0.689023763,0], X, Y,size=500)
X,Y = m(-2.9891401,55.947088)
draw_pie(ax,[0.387084686,0.612915314,0,0], X, Y,size=500)
X,Y = m(-2.8312323,56.019057)
draw_pie(ax,[0.206322248,0,0.793677752,0], X, Y,size=500)
X,Y = m(-2.9891401,55.947088)
draw_pie(ax,[0.155098699,0.532338761,0.31256254,0], X, Y,size=500)
X,Y = m(-2.8312323,56.019057)
draw_pie(ax,[0.854700855,0,0.145299145,0], X, Y,size=500)
X,Y = m(-2.8312323,56.019057)
draw_pie(ax,[0.755427703,0,0.244572297,0], X, Y,size=500)
X,Y = m(-3.3135832,56.257908)
draw_pie(ax,[0.193488372,0,0.806511628,0], X, Y,size=500)
X,Y = m(-2.9891401,55.947088)
draw_pie(ax,[0,0.921042545,0,0.078957455], X, Y,size=500)
X,Y = m(-3.3135832,56.257908)
draw_pie(ax,[0.289259192,0,0.710740808,0], X, Y,size=500)
X,Y = m(-2.8312323,56.019057)
draw_pie(ax,[0.066611917,0,0.933388083,0], X, Y,size=500)
X,Y = m(-2.8312323,56.019057)
draw_pie(ax,[0.237982579,0.103451984,0.658565437,0], X, Y,size=500)
X,Y = m(-3.3135832,56.257908)
draw_pie(ax,[0.194004996,0,0.805995004,0], X, Y,size=500)
X,Y = m(-2.8312323,56.019057)
draw_pie(ax,[0.222193812,0,0.777806188,0], X, Y,size=500)
X,Y = m(-2.8312323,56.019057)
draw_pie(ax,[0.077945402,0.922054598,0,0], X, Y,size=500)
X,Y = m(-2.8312323,56.019057)
draw_pie(ax,[0.369132508,0,0.630867492,0], X, Y,size=500)
X,Y = m(-2.8312323,56.019057)
draw_pie(ax,[0.229638342,0.770361658,0,0], X, Y,size=500)
X,Y = m(-2.8312323,56.019057)
draw_pie(ax,[0.14816087,0,0.85183913,0], X, Y,size=500)
X,Y = m(-2.8312323,56.019057)
draw_pie(ax,[0.181341719,0.556304283,0.262353998,0], X, Y,size=500)
X,Y = m(-2.8312323,56.019057)
draw_pie(ax,[0.068376068,0,0.931623932,0], X, Y,size=500)
X,Y = m(-2.8312323,56.019057)
draw_pie(ax,[0,0.679715302,0.320284698,0], X, Y,size=500)
X,Y = m(-2.8312323,56.019057)
draw_pie(ax,[0.19055794,0.189484979,0.619957082,0], X, Y,size=500)
X,Y = m(-2.8312323,56.019057)
draw_pie(ax,[0,0.910265744,0.089734256,0], X, Y,size=500)
X,Y = m(-2.8312323,56.019057)
draw_pie(ax,[0,0.397260274,0.602739726,0], X, Y,size=500)
X,Y = m(-2.8312323,56.019057)
draw_pie(ax,[0.21173398,0,0.78826602,0], X, Y,size=500)
X,Y = m(-2.8312323,56.019057)
draw_pie(ax,[0,0.406989247,0.593010753,0], X, Y,size=500)
X,Y = m(-2.8312323,56.019057)
draw_pie(ax,[0.324937552,0.162781016,0.512281432,0], X, Y,size=500)
X,Y = m(-2.8312323,56.019057)
draw_pie(ax,[0.099907979,0.900092021,0,0], X, Y,size=500)
X,Y = m(-2.8312323,56.019057)
draw_pie(ax,[0.085043988,0,0.914956012,0], X, Y,size=500)
X,Y = m(-2.8312323,56.019057)
draw_pie(ax,[0.099003804,0.824633219,0.076362978,0], X, Y,size=500)
X,Y = m(-2.8312323,56.019057)
draw_pie(ax,[0,0.619644723,0.380355277,0], X, Y,size=500)
X,Y = m(-2.8312323,56.019057)
draw_pie(ax,[0.282994198,0.717005802,0,0], X, Y,size=500)
X,Y = m(-3.03696,56.705261)
draw_pie(ax,[0.656518345,0,0.343481655,0], X, Y,size=500)
X,Y = m(-2.8699603,56.701948)
draw_pie(ax,[0.275575061,0,0.724424939,0], X, Y,size=500)
X,Y = m(-2.662709,56.626231)
draw_pie(ax,[0.136553162,0,0.863446838,0], X, Y,size=500)
X,Y = m(-2.662709,56.626231)
draw_pie(ax,[0.198001249,0,0.801998751,0], X, Y,size=500)
X,Y = m(-3.6465395,57.617227)
draw_pie(ax,[0.266360505,0,0.733639495,0], X, Y,size=500)
X,Y = m(-2.6000291,56.617215)
draw_pie(ax,[0.068263278,0,0.931736722,0], X, Y,size=500)
X,Y = m(-2.8994616,56.518604)
draw_pie(ax,[0.255623996,0,0.744376004,0], X, Y,size=500)
X,Y = m(-2.8994616,56.518604)
draw_pie(ax,[0.164588529,0,0.835411471,0], X, Y,size=500)
X,Y = m(-2.6000291,56.617215)
draw_pie(ax,[0.167425704,0,0.832574296,0], X, Y,size=500)
X,Y = m(-3.1037793,56.64389)
draw_pie(ax,[0.067040116,0,0.932959884,0], X, Y,size=500)
X,Y = m(-2.6772485,56.61539)
draw_pie(ax,[0.206543967,0,0.793456033,0], X, Y,size=500)
X,Y = m(-3.0756656,56.516044)
draw_pie(ax,[0.327980731,0,0.672019269,0], X, Y,size=500)
X,Y = m(-3.1518318,56.506197)
draw_pie(ax,[0.693667158,0,0.306332842,0], X, Y,size=500)
X,Y = m(-3.1553167,56.506991)
draw_pie(ax,[0.278015398,0,0.721984602,0], X, Y,size=500)
X,Y = m(-2.6048134,56.825418)
draw_pie(ax,[0.119573126,0,0.880426874,0], X, Y,size=500)
X,Y = m(-2.6048134,56.825418)
draw_pie(ax,[0.111683127,0,0.888316873,0], X, Y,size=500)
X,Y = m(-3.0295111,56.521449)
draw_pie(ax,[0.162081041,0,0.837918959,0], X, Y,size=500)
X,Y = m(-2.9217048,56.506285)
draw_pie(ax,[0.499525867,0,0.500474133,0], X, Y,size=500)
X,Y = m(-2.6048134,56.825418)
draw_pie(ax,[0.101478372,0,0.898521628,0], X, Y,size=500)
X,Y = m(-3.1021354,56.623869)
draw_pie(ax,[0.305194805,0,0.694805195,0], X, Y,size=500)
X,Y = m(-2.3141154,55.7483)
draw_pie(ax,[0,0.482909914,0.517090086,0], X, Y,size=500)
X,Y = m(-2.9277608,56.62973)
draw_pie(ax,[0.334877565,0,0.665122435,0], X, Y,size=500)
X,Y = m(-2.4311149,56.880544)
draw_pie(ax,[0.129332403,0.535705978,0.334961619,0], X, Y,size=500)
X,Y = m(-2.9961187,56.537291)
draw_pie(ax,[0.09886617,0.480478201,0.420655629,0], X, Y,size=500)
X,Y = m(-2.9319489,56.627039)
draw_pie(ax,[0,0.485194983,0.514805017,0], X, Y,size=500)
X,Y = m(-2.7817698,56.567915)
draw_pie(ax,[0,0.26541555,0.73458445,0], X, Y,size=500)
X,Y = m(-2.5715794,56.660346)
draw_pie(ax,[0.33290267,0,0.66709733,0], X, Y,size=500)
X,Y = m(-2.1972279,56.989498)
draw_pie(ax,[0,0.658896376,0.341103624,0], X, Y,size=500)
X,Y = m(-3.4358419,56.601399)
draw_pie(ax,[0.173913043,0.357346327,0.46874063,0], X, Y,size=500)
X,Y = m(-2.7763876,56.666541)
draw_pie(ax,[0.19142431,0,0.80857569,0], X, Y,size=500)
X,Y = m(-2.4190301,56.876893)
draw_pie(ax,[0,0.496425067,0.503574933,0], X, Y,size=500)
X,Y = m(-3.5244023,56.472595)
draw_pie(ax,[0.793760832,0,0.206239168,0], X, Y,size=500)
X,Y = m(-3.4834012,56.066887)
draw_pie(ax,[0,0.886654096,0.113345904,0], X, Y,size=500)
X,Y = m(-3.4834012,56.066887)
draw_pie(ax,[0.075981243,0,0.924018757,0], X, Y,size=500)
X,Y = m(-3.4834012,56.066887)
draw_pie(ax,[0.241348582,0,0.758651418,0], X, Y,size=500)
X,Y = m(-3.2262294,56.514721)
draw_pie(ax,[0,0.462782269,0.537217731,0], X, Y,size=500)
X,Y = m(-3.4834012,56.066887)
draw_pie(ax,[0.857142857,0,0.142857143,0], X, Y,size=500)
X,Y = m(-3.11799,57.63314)
draw_pie(ax,[0.342606149,0,0.657393851,0], X, Y,size=500)
X,Y = m(-2.6884459,56.764039)
draw_pie(ax,[0.139859069,0,0.860140931,0], X, Y,size=500)
X,Y = m(-2.6884459,56.764039)
draw_pie(ax,[0.442352941,0,0.557647059,0], X, Y,size=500)
X,Y = m(-2.9649494,56.674709)
draw_pie(ax,[0.295804228,0,0.704195772,0], X, Y,size=500)
X,Y = m(-2.5156773,56.599598)
draw_pie(ax,[0.125006859,0,0.874993141,0], X, Y,size=500)
X,Y = m(-2.5156773,56.599598)
draw_pie(ax,[0.406314063,0,0.593685937,0], X, Y,size=500)
X,Y = m(-2.5156773,56.599598)
draw_pie(ax,[0.691848058,0,0.308151942,0], X, Y,size=500)
X,Y = m(-2.5156773,56.599598)
draw_pie(ax,[0.354355165,0,0.645644835,0], X, Y,size=500)
X,Y = m(-2.6662476,56.263059)
draw_pie(ax,[0,0.121869352,0.878130648,0], X, Y,size=500)
X,Y = m(-2.8409567,56.501908)
draw_pie(ax,[0.109731966,0,0.890268034,0], X, Y,size=500)
X,Y = m(-2.7716825,56.710924)
draw_pie(ax,[0.525886194,0,0.474113806,0], X, Y,size=500)
X,Y = m(-2.7872923,56.547046)
draw_pie(ax,[0.435450105,0,0.564549895,0], X, Y,size=500)

plt.show()
